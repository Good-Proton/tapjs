{"version":3,"file":"diags.js","sourceRoot":"","sources":["../../src/diags.ts"],"names":[],"mappings":"AAAA,OAAO,IAAI,MAAM,UAAU,CAAA;AAC3B,OAAO,EAAE,eAAe,EAAE,MAAM,wBAAwB,CAAA;AAGxD,MAAM,aAAa,GAAG,CAAC,CAAQ,EAAE,EAAE;IACjC,KAAK,MAAM,CAAC,IAAI,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC;QACjC,IAAI,CAAC,KAAK,SAAS,IAAI,CAAC,KAAK,IAAI;YAAE,OAAO,IAAI,CAAA;IAChD,CAAC;IACD,OAAO,KAAK,CAAA;AACd,CAAC,CAAA;AAED;;;GAGG;AACH,MAAM,CAAC,MAAM,KAAK,GAAG,CAAC,GAAU,EAAE,EAAE;IAClC,MAAM,KAAK,GAAG,eAAe,CAAC,GAAG,CAAC,CAAA;IAClC,IAAI,CAAC,KAAK,IAAI,OAAO,KAAK,KAAK,QAAQ,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,EAAE,CAAC;QACjE,OAAO,EAAE,CAAA;IACX,CAAC;IACD,OAAO,CACL,SAAS;QACT,IAAI;aACD,SAAS,CAAC,KAAK,CAAC;aAChB,KAAK,CAAC,IAAI,CAAC;aACX,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,IAAI,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC;aAC1C,IAAI,CAAC,IAAI,CAAC;QACb,SAAS,CACV,CAAA;AACH,CAAC,CAAA","sourcesContent":["import yaml from 'tap-yaml'\r\nimport { cleanYamlObject } from './clean-yaml-object.js'\r\nimport { Extra } from './index.js'\r\n\r\nconst hasDefinedKey = (o: Extra) => {\r\n  for (const v of Object.values(o)) {\r\n    if (v !== undefined && v !== null) return true\r\n  }\r\n  return false\r\n}\r\n\r\n/**\r\n * Print the YAML diagnostics based on the {@link @tapjs/core!index.Extra}\r\n * object received\r\n */\r\nexport const diags = (obj: Extra) => {\r\n  const clean = cleanYamlObject(obj)\r\n  if (!clean || typeof clean !== 'object' || !hasDefinedKey(clean)) {\r\n    return ''\r\n  }\r\n  return (\r\n    '  ---\\n' +\r\n    yaml\r\n      .stringify(clean)\r\n      .split('\\n')\r\n      .map(l => (l.trim() ? '  ' + l : l.trim()))\r\n      .join('\\n') +\r\n    '  ...\\n'\r\n  )\r\n}\r\n"]}